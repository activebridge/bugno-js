!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.bugno=e():t.bugno=e()}(this,function(){return r={},o.m=n=[function(t,e,n){var y=n(10),i={},r=!1;function p(t,e){return e===b(t)}function b(t){var e=typeof t;return"object"!=e?e:t?t instanceof Error?"error":{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase():"null"}function a(t){return p(t,"function")}function o(t){var e=Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?"),n=RegExp("^"+e+"$");return function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}(t)&&n.test(t)}function u(t,e,n){var r,o,i,a=p(t,"object"),s=p(t,"array"),u=[];if(a&&-1!==n.indexOf(t))return t;if(n.push(t),a)for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&u.push(r);else if(s)for(i=0;i<t.length;++i)u.push(i);var c=a?{}:[],l=!0;for(i=0;i<u.length;++i)o=t[r=u[i]],c[r]=e(r,o,n),l=l&&c[r]===t[r];return 0==u.length||l?t:c}function s(){return"********"}function w(){var n=x();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===t?e:7&e|8).toString(16)})}r||(r=!0,p(JSON,"undefined")||(o(JSON.stringify)&&(i.stringify=JSON.stringify),o(JSON.parse)&&(i.parse=JSON.parse)),a(i.stringify)&&a(i.parse)||n(11)(i));var c={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};function l(e,n){var r,o;try{r=i.stringify(e)}catch(t){if(n&&a(n))try{r=n(e)}catch(t){o=t}else o=t}return{error:o,value:r}}function _(n,r){return function(t,e){try{r(t,e)}catch(t){n.error(t)}}}var f=["log","network","dom","navigation","error","manual"],h=["critical","error","warning","info","debug"];function d(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1}function x(){return Date.now?+Date.now():+new Date}t.exports={addParamsAndAccessTokenToPath:function(t,e,n){(n=n||{}).access_token=t;var r,o=[];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&o.push([r,n[r]].join("="));var i="?"+o.sort().join("&");(e=e||{}).path=e.path||"";var a,s=e.path.indexOf("?"),u=e.path.indexOf("#");-1!==s&&(-1===u||s<u)?(a=e.path,e.path=a.substring(0,s)+i+"&"+a.substring(s+1)):-1!==u?(a=e.path,e.path=a.substring(0,u)+i+a.substring(u)):e.path=e.path+i},createItem:function(t,e,n,r,o){for(var i,a,s,u,c,l,p=[],f=0,h=t.length;f<h;++f){var d=b(l=t[f]);switch(d){case"undefined":break;case"string":i?p.push(l):i=l;break;case"function":u=_(e,l);break;case"date":p.push(l);break;case"error":case"domexception":case"exception":a?p.push(l):a=l;break;case"object":case"array":if(l instanceof Error||"undefined"!=typeof DOMException&&l instanceof DOMException){a?p.push(l):a=l;break}if(r&&"object"===d&&!c){for(var g=0,m=r.length;g<m;++g)if(void 0!==l[r[g]]){c=l;break}if(c)break}s?p.push(l):s=l;break;default:if(l instanceof Error||"undefined"!=typeof DOMException&&l instanceof DOMException){a?p.push(l):a=l;break}p.push(l)}}0<p.length&&((s=y(s)).extraArgs=p);var v={message:i,err:a,custom:s,timestamp:x(),callback:u,uuid:w()};return s&&void 0!==s.level&&(v.level=s.level,delete s.level),r&&c&&(v.request=c),o&&(v.lambdaContext=o),v._originalArgs=t,v},createTelemetryEvent:function(t){for(var e,n,r,o,i=0,a=t.length;i<a;++i){switch(b(o=t[i])){case"string":d(f,o)?e=o:d(h,o)&&(r=o);break;case"object":n=o}}return{type:e||"manual",metadata:n||{},level:r}},filterIp:function(t,e){if(t&&t.user_ip&&!0!==e){var n=t.user_ip;if(e)try{var r;if(-1!==n.indexOf("."))(r=n.split(".")).pop(),r.push("0"),n=r.join(".");else if(-1!==n.indexOf(":")){if(2<(r=n.split(":")).length){var o=r.slice(0,3),i=o[2].indexOf("/");-1!==i&&(o[2]=o[2].substring(0,i));n=o.concat("0000:0000:0000:0000:0000").join(":")}}else n=null}catch(t){n=null}else n=null;t.user_ip=n}},formatArgsAsString:function(t){var e,n,r,o=[];for(e=0,n=t.length;e<n;++e){switch(b(r=t[e])){case"object":500<(r=(r=l(r)).error||r.value).length&&(r=r.substr(0,497)+"...");break;case"null":r="null";break;case"undefined":r="undefined";break;case"symbol":r=r.toString()}o.push(r)}return o.join(" ")},formatUrl:function(t,e){if(!(e=e||t.protocol)&&t.port&&(80===t.port?e="http:":443===t.port&&(e="https:")),e=e||"https:",!t.hostname)return null;var n=e+"//"+t.hostname;return t.port&&(n=n+":"+t.port),t.path&&(n+=t.path),n},get:function(t,e){if(t){var n=e.split("."),r=t;try{for(var o=0,i=n.length;o<i;++o)r=r[n[o]]}catch(t){r=void 0}return r}},handleOptions:function(t,e,n){var r=y(t,e,n);return!e||e.overwriteScrubFields||e.scrubFields&&(r.scrubFields=(t.scrubFields||[]).concat(e.scrubFields)),r},isError:function(t){return p(t,"error")||p(t,"exception")},isFunction:a,isIterable:function(t){var e=b(t);return"object"===e||"array"===e},isNativeFunction:o,isType:p,jsonParse:function(t){var e,n;try{e=i.parse(t)}catch(t){n=t}return{error:n,value:e}},LEVELS:{debug:0,info:1,warning:2,error:3,critical:4},makeUnhandledStackInfo:function(t,e,n,r,o,i,a,s){var u={url:e||"",line:n,column:r};u.func=s.guessFunctionName(u.url,u.line),u.context=s.gatherContext(u.url,u.line);var c=document&&document.location&&document.location.href,l=window&&window.navigator&&window.navigator.userAgent;return{mode:i,message:o?String(o):t||a,url:c,stack:[u],useragent:l}},merge:y,now:x,redact:s,sanitizeUrl:function(t){var e=function(t){if(!p(t,"string"))return;for(var r=c,e=r.parser[r.strictMode?"strict":"loose"].exec(t),o={},n=0,i=r.key.length;n<i;++n)o[r.key[n]]=e[n]||"";return o[r.q.name]={},o[r.key[12]].replace(r.q.parser,function(t,e,n){e&&(o[r.q.name][e]=n)}),o}(t);return e?(""===e.anchor&&(e.source=e.source.replace("#","")),t=e.source.replace("?"+e.query,"")):"(unknown)"},scrub:function(t,e){var i=function(t){for(var e,n=[],r=0;r<t.length;++r)e="^\\[?(%5[bB])?"+t[r]+"\\[?(%5[bB])?\\]?(%5[dD])?$",n.push(new RegExp(e,"i"));return n}(e=e||[]),a=function(t){for(var e,n=[],r=0;r<t.length;++r)e="\\[?(%5[bB])?"+t[r]+"\\[?(%5[bB])?\\]?(%5[dD])?",n.push(new RegExp("("+e+"=)([^&\\n]+)","igm"));return n}(e);function s(t,e){return e+"********"}return u(t,function t(e,n,r){var o=function(t,e){var n;for(n=0;n<i.length;++n)if(i[n].test(t)){e="********";break}return e}(e,n);return o===n?p(n,"object")||p(n,"array")?u(n,t,r):function(t){var e;if(p(t,"string"))for(e=0;e<a.length;++e)t=t.replace(a[e],s);return t}(o):o},[])},set:function(t,e,n){if(t){var r=e.split("."),o=r.length;if(!(o<1))if(1!==o)try{for(var i=t[r[0]]||{},a=i,s=1;s<o-1;++s)i[r[s]]=i[r[s]]||{},i=i[r[s]];i[r[o-1]]=n,t[r[0]]=a}catch(t){return}else t[r[0]]=n}},stringify:l,traverse:u,typeName:b,uuid4:w}},function(t,e,n){n(20);var r=n(21),o=n(0);t.exports={error:function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("Bugno:"),r.ieVersion()<=8?console.error(o.formatArgsAsString(t)):console.error.apply(console,t)},info:function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("Bugno:"),r.ieVersion()<=8?console.info(o.formatArgsAsString(t)):console.info.apply(console,t)},log:function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("Bugno:"),r.ieVersion()<=8?console.log(o.formatArgsAsString(t)):console.log.apply(console,t)}}},function(t,e,n){var s=n(0);function c(t,e){return[t,s.stringify(t,e)]}function u(t,e){var n=t.length;return 2*e<n?t.slice(0,e).concat(t.slice(n-e)):t}function l(t,e,n){n=void 0===n?30:n;var r,o=t.data.body;if(o.trace_chain)for(var i=o.trace_chain,a=0;a<i.length;a++)r=u(r=i[a].frames,n),i[a].frames=r;else o.trace&&(r=u(r=o.trace.frames,n),o.trace.frames=r);return[t,s.stringify(t,e)]}function i(t,e){return e&&e.length>t?e.slice(0,t-3).concat("..."):e}function p(o,t,e){return[t=s.traverse(t,function t(e,n,r){switch(s.typeName(n)){case"string":return i(o,n);case"object":case"array":return s.traverse(n,t,r);default:return n}},[]),s.stringify(t,e)]}function a(t){return t.exception&&(delete t.exception.description,t.exception.message=i(255,t.exception.message)),t.frames=u(t.frames,1),t}function f(t,e){var n=t.data.body;if(n.trace_chain)for(var r=n.trace_chain,o=0;o<r.length;o++)r[o]=a(r[o]);else n.trace&&(n.trace=a(n.trace));return[t,s.stringify(t,e)]}t.exports={truncate:function(t,e,n){n=void 0===n?524288:n;for(var r,o,i,a,s,u=[c,l,p.bind(null,1024),p.bind(null,512),p.bind(null,256),f];r=u.shift();)if(t=(o=r(t,e))[0],(i=o[1]).error||(a=i.value,s=n,!(a.length>s)))return i;return i},raw:c,truncateFrames:l,truncateStrings:p,maybeTruncateValue:i}},function(t,e){t.exports={parse:function(t){var e,n,r={protocol:null,auth:null,host:null,path:null,hash:null,href:t,hostname:null,port:null,pathname:null,search:null,query:null};if(n=-1!==(e=t.indexOf("//"))?(r.protocol=t.substring(0,e),e+2):0,-1!==(e=t.indexOf("@",n))&&(r.auth=t.substring(n,e),n=e+1),-1===(e=t.indexOf("/",n))){if(-1===(e=t.indexOf("?",n)))return-1===(e=t.indexOf("#",n))?r.host=t.substring(n):(r.host=t.substring(n,e),r.hash=t.substring(e)),r.hostname=r.host.split(":")[0],r.port=r.host.split(":")[1],r.port&&(r.port=parseInt(r.port,10)),r;r.host=t.substring(n,e),r.hostname=r.host.split(":")[0],r.port=r.host.split(":")[1],r.port&&(r.port=parseInt(r.port,10)),n=e}else r.host=t.substring(n,e),r.hostname=r.host.split(":")[0],r.port=r.host.split(":")[1],r.port&&(r.port=parseInt(r.port,10)),n=e;if(-1===(e=t.indexOf("#",n))?r.path=t.substring(n):(r.path=t.substring(n,e),r.hash=t.substring(e)),r.path){var o=r.path.split("?");r.pathname=o[0],r.query=o[1],r.search=r.query?"?"+r.query:null}return r}}},function(t,e,n){var i=n(25),r=new RegExp("^(([a-zA-Z0-9-_$ ]*): *)?(Uncaught )?([a-zA-Z0-9-_$ ]*): ");function o(){return null}function a(t){var e={};return e._stackFrame=t,e.url=t.fileName,e.line=t.lineNumber,e.func=t.functionName,e.column=t.columnNumber,e.args=t.args,e.context=null,e}function s(o){var t=o.constructor&&o.constructor.name;return t&&t.length&&!(t.length<3)||(t=o.name),{stack:function(){var e,n=[];if(o.stack)e=o;else try{throw o}catch(t){e=t}try{n=i.parse(e)}catch(t){n=[]}for(var t=[],r=0;r<n.length;r++)t.push(new a(n[r]));return t}(),message:o.message,name:t,rawStack:o.stack,rawException:o}}t.exports={guessFunctionName:function(){return"?"},guessErrorClass:function(t){if(!t||!t.match)return["Unknown error. There was no error message to display.",""];var e=t.match(r),n="(unknown)";return e&&(n=e[e.length-1],t=(t=t.replace((e[e.length-2]||"")+n+":","")).replace(/(^[\s]+|[\s]+$)/g,"")),[n,t]},gatherContext:o,parse:function(t){return new s(t)},Stack:s,Frame:a}},function(t,e,n){t.exports=n(6)},function(t,e,n){var r=n(7),o="undefined"!=typeof window&&window._bugnoConfig,i=o&&o.globalAlias||"Bugno",a="undefined"!=typeof window&&window[i]&&"function"==typeof window[i].shimId&&void 0!==window[i].shimId();if("undefined"==typeof window||window._bugnoStartTime||(window._bugnoStartTime=(new Date).getTime()),!a&&o){var s=new r(o);window[i]=s}else"undefined"!=typeof window?(window.bugno=r,window._bugnoDidLoad=!0):"undefined"!=typeof self&&(self.bugno=r,self._bugnoDidLoad=!0);t.exports=r},function(t,e,n){var i=n(8),u=n(0),a=n(18),s=n(1),r=n(22),c=n(23),l=n(3),p=n(24),f=n(27),h=n(28),d=n(29),g=n(4),m=n(30);function o(t,e){this.options=u.handleOptions(function(t){return{version:"0.1.0",scrubFields:["pw","pass","passwd","password","secret","confirm_password","confirmPassword","password_confirmation","passwordConfirmation","access_token","accessToken","secret_key","secretKey","secretToken","cc-number","card number","cardnumber","cardnum","ccnum","ccnumber","cc num","creditcardnumber","credit card number","newcreditcardnumber","new credit card","creditcardno","credit card no","card#","card #","cc-csc","cvc2","cvv2","ccv2","security code","card verification","name on credit card","name on card","nameoncard","cardholder","card holder","name des karteninhabers","card type","cardtype","cc type","cctype","payment type","expiration date","expirationdate","expdate","cc-exp"],logLevel:"debug",reportLevel:"debug",uncaughtErrorLevel:"error",verbose:!1,endpoint:"api.bugno.io/api/v1/projects/"+t+"/events",enabled:!0,sendConfig:!1,includeItemsInTelemetry:!0,captureIp:!0}}(t.accessToken),t);var n=new a(this.options,c,l);this.client=e||new i(this.options,n,s,"browser");var r=w(),o="undefined"!=typeof document&&document;!function(t,e){t.addTransform(p.handleItemWithError).addTransform(p.ensureItemHasSomethingToSay).addTransform(p.addBaseInfo).addTransform(p.addRequestInfo(e)).addTransform(p.addClientInfo(e)).addTransform(p.addPluginInfo(e)).addTransform(p.addBody).addTransform(f.addMessageWithError).addTransform(f.addTelemetryData).addTransform(f.addConfigToPayload).addTransform(p.scrubPayload).addTransform(f.userTransform(s)).addTransform(f.itemToPayload)}(this.client.notifier,r),function(t){t.addPredicate(d.checkLevel).addPredicate(h.checkIgnore).addPredicate(d.userCheckIgnore(s)).addPredicate(d.urlIsNotBlacklisted(s)).addPredicate(d.urlIsWhitelisted(s)).addPredicate(d.messageIsIgnored(s))}(this.client.queue),this.setupUnhandledCapture(),this.instrumenter=new m(this.options,this.client.telemeter,this,r,o),this.instrumenter.instrument()}var v=null;function y(t){var e="Bugno is not initialized";s.error(e),t&&t(new Error(e))}function b(t){for(var e=0,n=t.length;e<n;++e)if(u.isFunction(t[e]))return t[e]}function w(){return"undefined"!=typeof window&&window||"undefined"!=typeof self&&self}o.init=function(t,e){return v?v.global(t).configure(t):v=new o(t,e)},o.prototype.global=function(t){return this.client.global(t),this},o.global=function(t){if(v)return v.global(t);y()},o.prototype.configure=function(t,e){var n=this.options,r={};return e&&(r={payload:e}),this.options=u.handleOptions(n,t,r),this.client.configure(this.options,e),this.instrumenter.configure(this.options),this.setupUnhandledCapture(),this},o.configure=function(t,e){if(v)return v.configure(t,e);y()},o.prototype.lastError=function(){return this.client.lastError},o.lastError=function(){if(v)return v.lastError();y()},o.prototype.log=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.log(t),{uuid:e}},o.log=function(){if(v)return v.log.apply(v,arguments);y(b(arguments))},o.prototype.debug=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.debug(t),{uuid:e}},o.debug=function(){if(v)return v.debug.apply(v,arguments);y(b(arguments))},o.prototype.info=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.info(t),{uuid:e}},o.info=function(){if(v)return v.info.apply(v,arguments);y(b(arguments))},o.prototype.warn=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.warn(t),{uuid:e}},o.warn=function(){if(v)return v.warn.apply(v,arguments);y(b(arguments))},o.prototype.warning=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.warning(t),{uuid:e}},o.warning=function(){if(v)return v.warning.apply(v,arguments);y(b(arguments))},o.prototype.error=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.error(t),{uuid:e}},o.error=function(){if(v)return v.error.apply(v,arguments);y(b(arguments))},o.prototype.critical=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.critical(t),{uuid:e}},o.critical=function(){if(v)return v.critical.apply(v,arguments);y(b(arguments))},o.prototype.buildJsonPayload=function(t){return this.client.buildJsonPayload(t)},o.buildJsonPayload=function(){if(v)return v.buildJsonPayload.apply(v,arguments);y()},o.prototype.sendJsonPayload=function(t){return this.client.sendJsonPayload(t)},o.sendJsonPayload=function(){if(v)return v.sendJsonPayload.apply(v,arguments);y()},o.prototype.setupUnhandledCapture=function(){var t=w();this.unhandledExceptionsInitialized||(this.options.captureUncaught||this.options.handleUncaughtExceptions)&&(r.captureUncaughtExceptions(t,this),r.wrapGlobals(t,this),this.unhandledExceptionsInitialized=!0),this.unhandledRejectionsInitialized||(this.options.captureUnhandledRejections||this.options.handleUnhandledRejections)&&(r.captureUnhandledRejections(t,this),this.unhandledRejectionsInitialized=!0)},o.prototype.handleUncaughtException=function(t,e,n,r,o,i){if(this.options.captureUncaught||this.options.handleUncaughtExceptions){var a,s=u.makeUnhandledStackInfo(t,e,n,r,o,"onerror","uncaught exception",g);u.isError(o)?(a=this._createItem([t,o,i]))._unhandledStackInfo=s:u.isError(e)?(a=this._createItem([t,e,i]))._unhandledStackInfo=s:(a=this._createItem([t,i])).stackInfo=s,a.level=this.options.uncaughtErrorLevel,a._isUncaught=!0,this.client.log(a)}},o.prototype.handleUnhandledRejection=function(t,e){if(this.options.captureUnhandledRejections||this.options.handleUnhandledRejections){var n="unhandled rejection was null or undefined!";if(t)if(t.message)n=t.message;else{var r=u.stringify(t);r.value&&(n=r.value)}var o,i=t&&t._bugnoContext||e&&e._bugnoContext;u.isError(t)?o=this._createItem([n,t,i]):(o=this._createItem([n,t,i])).stackInfo=u.makeUnhandledStackInfo(n,"",0,0,null,"unhandledrejection","",g),o.level=this.options.uncaughtErrorLevel,o._isUncaught=!0,o._originalArgs=o._originalArgs||[],o._originalArgs.push(e),this.client.log(o)}},o.prototype.wrap=function(n,t,r){try{var o;if(o=u.isFunction(t)?t:function(){return t||{}},!u.isFunction(n))return n;if(n._isWrap)return n;if(!n._bugno_wrapped&&(n._bugno_wrapped=function(){r&&u.isFunction(r)&&r.apply(this,arguments);try{return n.apply(this,arguments)}catch(t){var e=t;throw e&&window._bugnoWrappedError!==e&&(u.isType(e,"string")&&(e=new String(e)),e._bugnoContext=o()||{},e._bugnoContext._wrappedSource=n.toString(),window._bugnoWrappedError=e),e}},n._bugno_wrapped._isWrap=!0,n.hasOwnProperty))for(var e in n)n.hasOwnProperty(e)&&"_bugno_wrapped"!==e&&(n._bugno_wrapped[e]=n[e]);return n._bugno_wrapped}catch(t){return n}},o.wrap=function(t,e){if(v)return v.wrap(t,e);y()},o.prototype.captureEvent=function(){var t=u.createTelemetryEvent(arguments);return this.client.captureEvent(t.type,t.metadata,t.level)},o.captureEvent=function(){if(v)return v.captureEvent.apply(v,arguments);y()},o.prototype.captureDomContentLoaded=function(t,e){return e=e||new Date,this.client.captureDomContentLoaded(e)},o.prototype.captureLoad=function(t,e){return e=e||new Date,this.client.captureLoad(e)},o.prototype._createItem=function(t){return u.createItem(t,s,this)},t.exports=o},function(t,e,n){var r=n(9),o=n(15),i=n(16),a=n(17),s=n(0);function u(t,e,n,r){this.options=s.merge(t),this.logger=n,u.rateLimiter.configureGlobal(this.options),u.rateLimiter.setPlatformOptions(r,this.options),this.api=e,this.queue=new o(u.rateLimiter,e,n,this.options),this.notifier=new i(this.queue,this.options),this.telemeter=new a(this.options),this.lastError=null,this.lastErrorHash="none"}u.rateLimiter=new r({maxItems:0,itemsPerMinute:60}),u.prototype.global=function(t){return u.rateLimiter.configureGlobal(t),this},u.prototype.configure=function(t,e){var n=this.options,r={};return e&&(r={payload:e}),this.options=s.merge(n,t,r),this.notifier&&this.notifier.configure(this.options),this.telemeter&&this.telemeter.configure(this.options),this.global(this.options),this},u.prototype.log=function(t){var e=this._defaultLogLevel();return this._log(e,t)},u.prototype.debug=function(t){this._log("debug",t)},u.prototype.info=function(t){this._log("info",t)},u.prototype.warn=function(t){this._log("warning",t)},u.prototype.warning=function(t){this._log("warning",t)},u.prototype.error=function(t){this._log("error",t)},u.prototype.critical=function(t){this._log("critical",t)},u.prototype.wait=function(t){this.queue.wait(t)},u.prototype.captureEvent=function(t,e,n){return this.telemeter.captureEvent(t,e,n)},u.prototype.captureDomContentLoaded=function(t){return this.telemeter.captureDomContentLoaded(t)},u.prototype.captureLoad=function(t){return this.telemeter.captureLoad(t)},u.prototype.buildJsonPayload=function(t){return this.api.buildJsonPayload(t)},u.prototype.sendJsonPayload=function(t){this.api.postJsonPayload(t)},u.prototype._log=function(t,e){var n;if(e.callback&&(n=e.callback,delete e.callback),this._sameAsLastError(e)){if(n){var r=new Error("ignored identical item");r.item=e,n(r)}}else try{e.level=e.level||t,this.telemeter._captureBugnoItem(e),e.telemetryEvents=this.telemeter.copyEvents(),this.notifier.log(e,n)}catch(t){this.logger.error(t)}},u.prototype._defaultLogLevel=function(){return this.options.logLevel||"debug"},u.prototype._sameAsLastError=function(t){if(!t._isUncaught)return!1;var e=function(t){var e=t.message||"",n=(t.err||{}).stack||String(t.err);return e+"::"+n}(t);return this.lastErrorHash===e||(this.lastError=t.err,this.lastErrorHash=e,!1)},t.exports=u},function(t,e,n){var s=n(0);function u(t){this.startTime=s.now(),this.counter=0,this.perMinCounter=0,this.platform=null,this.platformOptions={},this.configureGlobal(t)}function c(t,e,n){return!t.ignoreRateLimit&&1<=e&&e<n}function l(t,e,n,r,o,i,a){var s=null;return(n=n&&new Error(n))||r||(s=function(t,e,n,r,o){var i,a=e.environment||e.payload&&e.payload.environment;i=o?"item per minute limit reached, ignoring errors until timeout":"maxItems has been hit, ignoring errors until reset.";var s={body:{message:{body:i,extra:{maxItems:n,itemsPerMinute:r}}},language:"javascript",environment:a,notifier:{version:e.notifier&&e.notifier.version||e.version}};"browser"===t?(s.platform="browser",s.framework="browser-js",s.notifier.name="bugno-browser-js"):"server"===t?(s.framework=e.framework||"node-js",s.notifier.name=e.notifier.name):"react-native"===t&&(s.framework=e.framework||"react-native",s.notifier.name=e.notifier.name);return s}(t,e,o,i,a)),{error:n,shouldSend:r,payload:s}}u.globalSettings={startTime:s.now(),maxItems:void 0,itemsPerMinute:void 0},u.prototype.configureGlobal=function(t){void 0!==t.startTime&&(u.globalSettings.startTime=t.startTime),void 0!==t.maxItems&&(u.globalSettings.maxItems=t.maxItems),void 0!==t.itemsPerMinute&&(u.globalSettings.itemsPerMinute=t.itemsPerMinute)},u.prototype.shouldSend=function(t,e){var n=(e=e||s.now())-this.startTime;(n<0||6e4<=n)&&(this.startTime=e,this.perMinCounter=0);var r=u.globalSettings.maxItems,o=u.globalSettings.itemsPerMinute;if(c(t,r,this.counter))return l(this.platform,this.platformOptions,r+" max items reached",!1);if(c(t,o,this.perMinCounter))return l(this.platform,this.platformOptions,o+" items per minute reached",!1);this.counter++,this.perMinCounter++;var i=!c(t,r,this.counter),a=i;return i=i&&!c(t,o,this.perMinCounter),l(this.platform,this.platformOptions,null,i,r,o,a)},u.prototype.setPlatformOptions=function(t,e){this.platform=t,this.platformOptions=e},t.exports=u},function(t,e,n){"use strict";var o=Object.prototype.hasOwnProperty,i=Object.prototype.toString,c=function(t){if(!t||"[object Object]"!==i.call(t))return!1;var e,n=o.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&o.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;for(e in t);return void 0===e||o.call(t,e)};t.exports=function t(){var e,n,r,o,i,a={},s=null,u=arguments.length;for(e=0;e<u;e++)if(null!=(s=arguments[e]))for(i in s)n=a[i],a!==(r=s[i])&&(r&&c(r)?(o=n&&c(n)?n:{},a[i]=t(o,r)):void 0!==r&&(a[i]=r));return a}},function(t,l,p){(function(s,u){var c;/*! JSON v3.3.2 | https://bestiejs.github.io/json3 | Copyright 2012-2015, Kit Cambridge, Benjamin Tan | http://kit.mit-license.org */ /*! JSON v3.3.2 | https://bestiejs.github.io/json3 | Copyright 2012-2015, Kit Cambridge, Benjamin Tan | http://kit.mit-license.org */
(function(){function R(t,s){function h(t,e){try{t()}catch(t){e&&e()}}function u(t){if(null!=u[t])return u[t];if("bug-string-char-index"==t)var e=!1;else if("json"==t)e=u("json-stringify")&&u("date-serialization")&&u("json-parse");else if("date-serialization"==t){if(e=u("json-stringify")&&b){var n=s.stringify;h(function(){e='"-271821-04-20T00:00:00.000Z"'==n(new d(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==n(new d(864e13))&&'"-000001-01-01T00:00:00.000Z"'==n(new d(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==n(new d(-1))})}}else{var r;if("json-stringify"==t){var o="function"==typeof(n=s.stringify);o&&((r=function(){return 1}).toJSON=r,h(function(){o="0"===n(0)&&"0"===n(new c)&&'""'==n(new l)&&n(y)===v&&n(v)===v&&n()===v&&"1"===n(r)&&"[1]"==n([r])&&"[null]"==n([v])&&"null"==n(null)&&"[null,null,null]"==n([v,y,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==n({a:[r,!0,!1,null,"\0\b\n\f\r\t"]})&&"1"===n(null,r)&&"[\n 1,\n 2\n]"==n([1,2],null,1)},function(){o=!1})),e=o}if("json-parse"==t){var i,a=s.parse;"function"==typeof a&&h(function(){0===a("0")&&!a(!1)&&(r=a('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'),i=5==r.a.length&&1===r.a[0])&&(h(function(){i=!a('"\t"')}),i&&h(function(){i=1!==a("01")}),i&&h(function(){i=1!==a("1.")}))},function(){i=!1}),e=i}}return u[t]=!!e}t=t||F.Object(),s=s||F.Object();var c=t.Number||F.Number,l=t.String||F.String,e=t.Object||F.Object,d=t.Date||F.Date,n=t.SyntaxError||F.SyntaxError,g=t.TypeError||F.TypeError,m=t.Math||F.Math;"object"==typeof(t=t.JSON||F.JSON)&&t&&(s.stringify=t.stringify,s.parse=t.parse);var v,y=(e=e.prototype).toString,a=e.hasOwnProperty,b=new d(-0xc782b5b800cec);if(h(function(){b=-109252==b.getUTCFullYear()&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}),u["bug-string-char-index"]=u["date-serialization"]=u.json=u["json-stringify"]=u["json-parse"]=null,!u("json")){var p=u("bug-string-char-index"),w=function(t,e){var n,r,o=0;(n=function(){this.valueOf=0}).prototype.valueOf=0;var i=new n;for(r in i)a.call(i,r)&&o++;return n=i=null,(w=o?function(t,e){var n,r,o="[object Function]"==y.call(t);for(n in t)o&&"prototype"==n||!a.call(t,n)||(r="constructor"===n)||e(n);(r||a.call(t,n="constructor"))&&e(n)}:(i="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),function(t,e){var n,r="[object Function]"==y.call(t),o=!r&&"function"!=typeof t.constructor&&q[typeof t.hasOwnProperty]&&t.hasOwnProperty||a;for(n in t)r&&"prototype"==n||!o.call(t,n)||e(n);for(r=i.length;n=i[--r];)o.call(t,n)&&e(n)}))(t,e)};if(!u("json-stringify")&&!u("date-serialization")){function _(t,e){return("000000"+(e||0)).slice(-t)}var r={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},x=function(t){var e,n,r,o,i,a,s,u;if(b)var c=function(t){e=t.getUTCFullYear(),n=t.getUTCMonth(),r=t.getUTCDate(),i=t.getUTCHours(),a=t.getUTCMinutes(),s=t.getUTCSeconds(),u=t.getUTCMilliseconds()};else{function l(t,e){return f[e]+365*(t-1970)+p((t-1969+(e=+(1<e)))/4)-p((t-1901+e)/100)+p((t-1601+e)/400)}var p=m.floor,f=[0,31,59,90,120,151,181,212,243,273,304,334];c=function(t){for(r=p(t/864e5),e=p(r/365.2425)+1970-1;l(e+1,0)<=r;e++);for(n=p((r-l(e,0))/30.42);l(e,n+1)<=r;n++);r=1+r-l(e,n),i=p((o=(t%864e5+864e5)%864e5)/36e5)%24,a=p(o/6e4)%60,s=p(o/1e3)%60,u=o%1e3}}return(x=function(t){return-1/0<t&&t<1/0?(c(t),t=(e<=0||1e4<=e?(e<0?"-":"+")+_(6,e<0?-e:e):_(4,e))+"-"+_(2,n+1)+"-"+_(2,r)+"T"+_(2,i)+":"+_(2,a)+":"+_(2,s)+"."+_(3,u)+"Z",e=n=r=i=a=s=u=null):t=null,t})(t)};if(u("json-stringify")&&!u("date-serialization")){function o(){return x(this)}var i=s.stringify;s.stringify=function(t,e,n){var r=d.prototype.toJSON;return d.prototype.toJSON=o,t=i(t,e,n),d.prototype.toJSON=r,t}}else{function f(t){t=t.charCodeAt(0);var e=r[t];return e||"\\u00"+_(2,t.toString(16))}function k(t){return E.lastIndex=0,'"'+(E.test(t)?t.replace(E,f):t)+'"'}var E=/[\x00-\x1f\x22\x5c]/g,I=function(t,e,n,r,o,i,a){var s,u;if(h(function(){s=e[t]}),"object"==typeof s&&s&&(s.getUTCFullYear&&"[object Date]"==y.call(s)&&s.toJSON===d.prototype.toJSON?s=x(s):"function"==typeof s.toJSON&&(s=s.toJSON(t))),n&&(s=n.call(e,t,s)),s==v)return s===v?s:"null";var c=typeof s;switch("object"==c&&(u=y.call(s)),u||c){case"boolean":case"[object Boolean]":return""+s;case"number":case"[object Number]":return-1/0<s&&s<1/0?""+s:"null";case"string":case"[object String]":return k(""+s)}if("object"==typeof s){for(c=a.length;c--;)if(a[c]===s)throw g();a.push(s);var l=[],p=i;if(i+=o,"[object Array]"==u){var f=0;for(c=s.length;f<c;f++)u=I(f,s,n,r,o,i,a),l.push(u===v?"null":u);c=l.length?o?"[\n"+i+l.join(",\n"+i)+"\n"+p+"]":"["+l.join(",")+"]":"[]"}else w(r||s,function(t){var e=I(t,s,n,r,o,i,a);e!==v&&l.push(k(t)+":"+(o?" ":"")+e)}),c=l.length?o?"{\n"+i+l.join(",\n"+i)+"\n"+p+"}":"{"+l.join(",")+"}":"{}";return a.pop(),c}};s.stringify=function(t,e,n){var r;if(q[typeof e]&&e){var o=y.call(e);if("[object Function]"==o)var i=e;else if("[object Array]"==o)for(var a,s={},u=0,c=e.length;u<c;)a=e[u++],"[object String]"!=(o=y.call(a))&&"[object Number]"!=o||(s[a]=1)}if(n)if("[object Number]"==(o=y.call(n))){if(0<(n-=n%1))for(10<n&&(n=10),r="";r.length<n;)r+=" "}else"[object String]"==o&&(r=n.length<=10?n:n.slice(0,10));return I("",((a={})[""]=t,a),i,s,r,"",[])}}}if(!u("json-parse")){function T(){throw j=C=null,n()}function S(){for(var t,e,n,r,o,i=C,a=i.length;j<a;)switch(o=i.charCodeAt(j),o){case 9:case 10:case 13:case 32:j++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=p?i.charAt(j):i[j],j++,t;case 34:for(t="@",j++;j<a;)if((o=i.charCodeAt(j))<32)T();else if(92==o)switch(o=i.charCodeAt(++j),o){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=L[o],j++;break;case 117:for(e=++j,n=j+4;j<n;j++)48<=(o=i.charCodeAt(j))&&o<=57||97<=o&&o<=102||65<=o&&o<=70||T();t+=N("0x"+i.slice(e,j));break;default:T()}else{if(34==o)break;for(o=i.charCodeAt(j),e=j;32<=o&&92!=o&&34!=o;)o=i.charCodeAt(++j);t+=i.slice(e,j)}if(34==i.charCodeAt(j))return j++,t;T();default:if(e=j,45==o&&(r=!0,o=i.charCodeAt(++j)),48<=o&&o<=57){for(48==o&&(48<=(o=i.charCodeAt(j+1))&&o<=57)&&T();j<a&&(48<=(o=i.charCodeAt(j))&&o<=57);j++);if(46==i.charCodeAt(j)){for(n=++j;n<a&&!((o=i.charCodeAt(n))<48||57<o);n++);n==j&&T(),j=n}if(101==(o=i.charCodeAt(j))||69==o){for(43!=(o=i.charCodeAt(++j))&&45!=o||j++,n=j;n<a&&!((o=i.charCodeAt(n))<48||57<o);n++);n==j&&T(),j=n}return+i.slice(e,j)}if(r&&T(),"true"==(t=i.slice(j,j+4)))return j+=4,!0;if("fals"==t&&101==i.charCodeAt(j+4))return j+=5,!1;if("null"==t)return j+=4,null;T()}return"$"}function O(t,e,n){(n=A(t,e,n))===v?delete t[e]:t[e]=n}var j,C,N=l.fromCharCode,L={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},P=function(t){var e;if("$"==t&&T(),"string"==typeof t){if("@"==(p?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];"]"!=(t=S());){if(n)","==t?"]"==(t=S())&&T():T();else var n=!0;","==t&&T(),e.push(P(t))}return e}if("{"==t){for(e={};"}"!=(t=S());)n?","==t?"}"==(t=S())&&T():T():n=!0,","!=t&&"string"==typeof t&&"@"==(p?t.charAt(0):t[0])&&":"==S()||T(),e[t.slice(1)]=P(S());return e}T()}return t},A=function(t,e,n){var r,o=t[e];if("object"==typeof o&&o)if("[object Array]"==y.call(o))for(r=o.length;r--;)O(y,w,o);else w(o,function(t){O(o,t,n)});return n.call(t,e,o)};s.parse=function(t,e){var n;return j=0,C=""+t,t=P(S()),"$"!=S()&&T(),j=C=null,e&&"[object Function]"==y.call(e)?A(((n={})[""]=t,n),"",e):t}}}return s.runInContext=R,s}var t=p(14),q={function:!0,object:!0},e=q[typeof l]&&l&&!l.nodeType&&l,F=q[typeof window]&&window||this,n=e&&q[typeof s]&&s&&!s.nodeType&&"object"==typeof u&&u;if(!n||n.global!==n&&n.window!==n&&n.self!==n||(F=n),e&&!t)R(F,e);else{var r=F.JSON,o=F.JSON3,i=!1,a=R(F,F.JSON3={noConflict:function(){return i||(i=!0,F.JSON=r,F.JSON3=o,r=o=null),a}});F.JSON={parse:a.parse,stringify:a.stringify}}t&&(void 0===(c=function(){return a}.call(l,p,l,s))||(s.exports=c))}).call(this)}).call(this,p(12)(t),p(13))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(e,t){(function(t){e.exports=t}).call(this,{})},function(t,e,n){var i=n(0);function r(t,e,n,r){this.rateLimiter=t,this.api=e,this.logger=n,this.options=r,this.predicates=[],this.pendingItems=[],this.pendingRequests=[],this.retryQueue=[],this.retryHandle=null,this.waitCallback=null,this.waitIntervalID=null}r.prototype.configure=function(t){this.api&&this.api.configure(t);var e=this.options;return this.options=i.merge(e,t),this},r.prototype.addPredicate=function(t){return i.isFunction(t)&&this.predicates.push(t),this},r.prototype.addPendingItem=function(t){this.pendingItems.push(t)},r.prototype.removePendingItem=function(t){var e=this.pendingItems.indexOf(t);-1!==e&&this.pendingItems.splice(e,1)},r.prototype.addItem=function(n,r,t,e){r&&i.isFunction(r)||(r=function(){});var o=this._applyPredicates(n);if(o.stop)return this.removePendingItem(e),void r(o.err);this._maybeLog(n,t),this.removePendingItem(e),this.pendingRequests.push(n);try{this._makeApiRequest(n,function(t,e){this._dequeuePendingRequest(n),r(t,e)}.bind(this))}catch(t){this._dequeuePendingRequest(n),r(t)}},r.prototype.wait=function(t){i.isFunction(t)&&(this.waitCallback=t,this._maybeCallWait()||(this.waitIntervalID&&(this.waitIntervalID=clearInterval(this.waitIntervalID)),this.waitIntervalID=setInterval(function(){this._maybeCallWait()}.bind(this),500)))},r.prototype._applyPredicates=function(t){for(var e=null,n=0,r=this.predicates.length;n<r;n++)if(!(e=this.predicates[n](t,this.options))||void 0!==e.err)return{stop:!0,err:e.err};return{stop:!1,err:null}},r.prototype._makeApiRequest=function(n,r){var t=this.rateLimiter.shouldSend(n);t.shouldSend?this.api.postItem(n,function(t,e){t?this._maybeRetry(t,n,r):r(t,e)}.bind(this)):t.error?r(t.error):this.api.postItem(t.payload,r)};var a=["ECONNRESET","ENOTFOUND","ESOCKETTIMEDOUT","ETIMEDOUT","ECONNREFUSED","EHOSTUNREACH","EPIPE","EAI_AGAIN"];r.prototype._maybeRetry=function(t,e,n){var r=!1;if(this.options.retryInterval)for(var o=0,i=a.length;o<i;o++)if(t.code===a[o]){r=!0;break}r?this._retryApiRequest(e,n):n(t)},r.prototype._retryApiRequest=function(t,e){this.retryQueue.push({item:t,callback:e}),this.retryHandle||(this.retryHandle=setInterval(function(){for(;this.retryQueue.length;){var t=this.retryQueue.shift();this._makeApiRequest(t.item,t.callback)}}.bind(this),this.options.retryInterval))},r.prototype._dequeuePendingRequest=function(t){var e=this.pendingRequests.indexOf(t);-1!==e&&(this.pendingRequests.splice(e,1),this._maybeCallWait())},r.prototype._maybeLog=function(t,e){if(this.logger&&this.options.verbose){var n=e;if(n=(n=n||i.get(t,"body.trace.exception.message"))||i.get(t,"body.trace_chain.0.exception.message"))return void this.logger.error(n);(n=i.get(t,"body.message.body"))&&this.logger.log(n)}},r.prototype._maybeCallWait=function(){return!(!i.isFunction(this.waitCallback)||0!==this.pendingItems.length||0!==this.pendingRequests.length)&&(this.waitIntervalID&&(this.waitIntervalID=clearInterval(this.waitIntervalID)),this.waitCallback(),!0)},t.exports=r},function(t,e,n){var i=n(0);function r(t,e){this.queue=t,this.options=e,this.transforms=[]}r.prototype.configure=function(t){this.queue&&this.queue.configure(t);var e=this.options;return this.options=i.merge(e,t),this},r.prototype.addTransform=function(t){return i.isFunction(t)&&this.transforms.push(t),this},r.prototype.log=function(n,r){if(r&&i.isFunction(r)||(r=function(){}),!this.options.enabled)return r(new Error("Bugno is not enabled"));this.queue.addPendingItem(n);var o=n.err;this._applyTransforms(n,function(t,e){if(t)return this.queue.removePendingItem(n),r(t,null);this.queue.addItem(e,r,o,n)}.bind(this))},r.prototype._applyTransforms=function(t,n){var r=-1,o=this.transforms.length,i=this.transforms,a=this.options,s=function(t,e){t?n(t,null):++r!==o?i[r](e,a,s):n(null,e)};s(null,t)},t.exports=r},function(t,e,n){var a=n(0);function r(t){this.queue=[],this.options=a.merge(t);var e=this.options.maxTelemetryEvents||100;this.maxQueueSize=Math.max(0,Math.min(e,100))}r.prototype.configure=function(t){var e=this.options;this.options=a.merge(e,t);var n=this.options.maxTelemetryEvents||100,r=Math.max(0,Math.min(n,100)),o=0;this.maxQueueSize>r&&(o=this.maxQueueSize-r),this.maxQueueSize=r,this.queue.splice(0,o)},r.prototype.copyEvents=function(){var t=Array.prototype.slice.call(this.queue,0);if(a.isFunction(this.options.filterTelemetry))try{for(var e=t.length;e--;)this.options.filterTelemetry(t[e])&&t.splice(e,1)}catch(t){this.options.filterTelemetry=null}return t},r.prototype.capture=function(t,e,n,r,o){var i={level:function(t,e){if(e)return e;return{error:"error",manual:"info"}[t]||"info"}(t,n),type:t,timestamp_ms:o||a.now(),body:e,source:"client"};r&&(i.uuid=r);try{if(a.isFunction(this.options.filterTelemetry)&&this.options.filterTelemetry(i))return!1}catch(t){this.options.filterTelemetry=null}return this.push(i),i},r.prototype.captureEvent=function(t,e,n,r){return this.capture(t,e,n,r)},r.prototype.captureError=function(t,e,n,r){var o={message:t.message||String(t)};return t.stack&&(o.stack=t.stack),this.capture("error",o,e,n,r)},r.prototype.captureLog=function(t,e,n,r){return this.capture("log",{message:t},e,n,r)},r.prototype.captureNetwork=function(t,e,n,r){e=e||"xhr",t.subtype=t.subtype||e,r&&(t.request=r);var o=this.levelFromStatus(t.status_code);return this.capture("network",t,o,n)},r.prototype.levelFromStatus=function(t){return 200<=t&&t<400?"info":0===t||400<=t?"error":"info"},r.prototype.captureDom=function(t,e,n,r,o){var i={subtype:t,element:e};return void 0!==n&&(i.value=n),void 0!==r&&(i.checked=r),this.capture("dom",i,"info",o)},r.prototype.captureNavigation=function(t,e,n){return this.capture("navigation",{from:t,to:e},"info",n)},r.prototype.captureDomContentLoaded=function(t){return this.capture("navigation",{subtype:"DOMContentLoaded"},"info",void 0,t&&t.getTime())},r.prototype.captureLoad=function(t){return this.capture("navigation",{subtype:"load"},"info",void 0,t&&t.getTime())},r.prototype.captureConnectivityChange=function(t,e){return this.captureNetwork({change:t},"connectivity",e)},r.prototype._captureBugnoItem=function(t){if(this.options.includeItemsInTelemetry)return t.err?this.captureError(t.err,t.level,t.uuid,t.timestamp):t.message?this.captureLog(t.message,t.level,t.uuid,t.timestamp):t.custom?this.capture("log",t.custom,t.level,t.uuid,t.timestamp):void 0},r.prototype.push=function(t){this.queue.push(t),this.queue.length>this.maxQueueSize&&this.queue.shift()},t.exports=r},function(t,e,n){var r=n(0),o=n(19),i=n(2);function a(t,e,n,r){this.options=t,this.transport=e,this.url=n,this.jsonBackup=r,this.accessToken=t.accessToken,this.transportOptions=s(t,n)}function s(t,e){return o.getTransportFromOptions(t,function(t){return{hostname:"api.bugno.io",path:"/api/v1/projects/"+t+"/events",search:null,version:"1",protocol:"https:",port:443}}(t.accessToken),e)}a.prototype.postItem=function(t,e){var n=o.transportOptions(this.transportOptions,"POST"),r=function(t){var e;return"browser-js"==t.framework?e={title:t.body.trace.exception.class,message:t.body.trace.exception.message,framework:t.framework,backtrace:t.body.trace.frames,ip_address:t.request.ip_address,url:t.request.url,person_data:t.client,params:t.request}:"node-js"==t.framework&&(e={title:t.body.trace_chain[0].exception.class,message:t.body.trace_chain[0].exception.message,server_data:{host:t.server.host,root:t.server.root},framework:t.framework,backtrace:t.body.trace_chain[0].frames,ip_address:t.request.ip_address,url:t.request.url,http_method:t.request.method,params:t.request.GET||t.request.POST,headers:t.request.headers}),e}(t);this.transport.post(this.accessToken,n,r,e)},a.prototype.buildJsonPayload=function(t,e){var n=o.buildPayload(this.accessToken,t,this.jsonBackup),r=i.truncate(n);return r.error?(e&&e(r.error),null):r.value},a.prototype.postJsonPayload=function(t,e){var n=o.transportOptions(this.transportOptions,"POST");this.transport.postJsonPayload(this.accessToken,n,t,e)},a.prototype.configure=function(t){var e=this.oldOptions;return this.options=r.merge(e,t),this.transportOptions=s(this.options,this.url),void 0!==this.options.accessToken&&(this.accessToken=this.options.accessToken),this},t.exports=a},function(t,e,n){var o=n(0);t.exports={buildPayload:function(t,e,n){if(!o.isType(e.context,"string")){var r=o.stringify(e.context,n);r.error?e.context="Error: could not serialize 'context'":e.context=r.value||"",255<e.context.length&&(e.context=e.context.substr(0,255))}return{access_token:t,data:e}},getTransportFromOptions:function(t,e,n){var r=e.hostname,o=e.protocol,i=e.port,a=e.path,s=e.search,u=t.proxy;if(t.endpoint){var c=n.parse(t.endpoint);r=c.hostname,o=c.protocol,i=c.port,a=c.pathname,s=c.search}return{hostname:r,protocol:o,port:i,path:a,search:s,proxy:u}},transportOptions:function(t,e){var n=t.protocol||"https:",r=t.port||("http:"===n?80:"https:"===n?443:void 0),o=t.hostname,i=t.path;return t.search&&(i+=t.search),t.proxy&&(i=n+"//"+o+i,o=t.proxy.host||t.proxy.hostname,r=t.proxy.port,n=t.proxy.protocol||n),{protocol:n,hostname:o,path:i,port:r,method:e}},appendPathToPath:function(t,e){var n=/\/$/.test(t),r=/^\//.test(e);return n&&r?e=e.substring(1):n||r||(e="/"+e),t+e}}},function(t,e){!function(t){"use strict";t.console||(t.console={});for(var e,n,r=t.console,o=function(){},i=["memory"],a="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");e=i.pop();)r[e]||(r[e]={});for(;n=a.pop();)r[n]||(r[n]=o)}("undefined"==typeof window?this:window)},function(t,e){var n={ieVersion:function(){if(document){for(var t=3,e=document.createElement("div"),n=e.getElementsByTagName("i");e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",n[0];);return 4<t?t:void 0}}};t.exports=n},function(t,e){function a(r,t,e){if(t.hasOwnProperty&&t.hasOwnProperty("addEventListener")){for(var o=t.addEventListener;o._bugnoOldAdd&&o.belongsToShim;)o=o._bugnoOldAdd;function n(t,e,n){o.call(this,t,r.wrap(e),n)}n._bugnoOldAdd=o,n.belongsToShim=e,t.addEventListener=n;for(var i=t.removeEventListener;i._bugnoOldRemove&&i.belongsToShim;)i=i._bugnoOldRemove;function a(t,e,n){i.call(this,t,e&&e._bugno_wrapped||e,n)}a._bugnoOldRemove=i,a.belongsToShim=e,t.removeEventListener=a}}t.exports={captureUncaughtExceptions:function(e,n,t){if(e){var r;if("function"==typeof n._bugnoOldOnError)r=n._bugnoOldOnError;else if(e.onerror){for(r=e.onerror;r._bugnoOldOnError;)r=r._bugnoOldOnError;n._bugnoOldOnError=r}function o(){var t=Array.prototype.slice.call(arguments,0);!function(t,e,n,r){t._bugnoWrappedError&&(r[4]||(r[4]=t._bugnoWrappedError),r[5]||(r[5]=t._bugnoWrappedError._bugnoContext),t._bugnoWrappedError=null);e.handleUncaughtException.apply(e,r),n&&n.apply(t,r)}(e,n,r,t)}t&&(o._bugnoOldOnError=r),e.onerror=o}},captureUnhandledRejections:function(t,o,e){if(t){"function"==typeof t._bugnoURH&&t._bugnoURH.belongsToShim&&t.removeEventListener("unhandledrejection",t._bugnoURH);function n(t){var e,n,r;try{e=t.reason}catch(t){e=void 0}try{n=t.promise}catch(t){n="[unhandledrejection] error getting `promise` from event"}try{r=t.detail,!e&&r&&(e=r.reason,n=r.promise)}catch(t){}e=e||"[unhandledrejection] error getting `reason` from event",o&&o.handleUnhandledRejection&&o.handleUnhandledRejection(e,n)}n.belongsToShim=e,t._bugnoURH=n,t.addEventListener("unhandledrejection",n)}},wrapGlobals:function(t,e,n){if(t){var r,o,i="EventTarget,Window,Node,ApplicationCache,AudioTrackList,ChannelMergerNode,CryptoOperation,EventSource,FileReader,HTMLUnknownElement,IDBDatabase,IDBRequest,IDBTransaction,KeyOperation,MediaController,MessagePort,ModalWindow,Notification,SVGElementInstance,Screen,TextTrack,TextTrackCue,TextTrackList,WebSocket,WebSocketWorker,Worker,XMLHttpRequest,XMLHttpRequestEventTarget,XMLHttpRequestUpload".split(",");for(r=0;r<i.length;++r)t[o=i[r]]&&t[o].prototype&&a(e,t[o].prototype,n)}}}},function(t,e,n){var c=n(0),s=n(2),l=n(1);function u(t,e,n,r,o,i){var a="undefined"!=typeof window&&window||"undefined"!=typeof self&&self,s=a&&a.Zone&&a.Zone.current;s&&"angular"===s._name?s._parent.run(function(){p(t,e,n,r,o,i)}):p(t,e,n,r,o,i)}function p(t,e,n,r,o,i){if("undefined"!=typeof BugnoProxy)return function(t,e){(new BugnoProxy).sendJsonPayload(t,function(t){},function(t){e(new Error(t))})}(r,o);var a;if(!(a=i?i():function(){var t,e,n=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],r=n.length;for(e=0;e<r;e++)try{t=n[e]();break}catch(t){}return t}()))return o(new Error("No way to send a request"));try{try{var s=function(){try{if(s&&4===a.readyState){s=void 0;var t=c.jsonParse(a.responseText);if(function(t){return t&&t.status&&200===t.status}(a))return void o(t.error,t.value);if(function(t){return t&&c.isType(t.status,"number")&&400<=t.status&&t.status<600}(a)){if(403===a.status){var e=t.value&&t.value.message;l.error(e)}o(new Error(String(a.status)))}else{o(f("XHR response had no status code (likely connection failure)"))}}}catch(t){var n;n=t&&t.stack?t:new Error(t),o(n)}};a.open(n,e,!0),a.setRequestHeader&&(a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-Bugno-Access-Token",t)),a.onreadystatechange=s,a.send(r)}catch(t){if("undefined"!=typeof XDomainRequest){if(!window||!window.location)return o(new Error("No window available during request, unknown environment"));"http:"===window.location.href.substring(0,5)&&"https"===e.substring(0,5)&&(e="http"+e.substring(5));var u=new XDomainRequest;u.onprogress=function(){},u.ontimeout=function(){o(f("Request timed out","ETIMEDOUT"))},u.onerror=function(){o(new Error("Error during request"))},u.onload=function(){var t=c.jsonParse(u.responseText);o(t.error,t.value)},u.open(n,e,!0),u.send(r)}else o(new Error("Cannot find a method to transport a request"))}}catch(t){o(t)}}function f(t,e){var n=new Error(t);return n.code=e||"ENOTFOUND",n}t.exports={get:function(t,e,n,r,o){r&&c.isFunction(r)||(r=function(){}),c.addParamsAndAccessTokenToPath(t,e,n),u(t,c.formatUrl(e),"GET",null,r,o)},post:function(t,e,n,r,o){if(r&&c.isFunction(r)||(r=function(){}),!n)return r(new Error("Cannot send empty request"));var i=s.truncate(n);if(i.error)return r(i.error);var a=i.value;u(t,c.formatUrl(e),"POST",a,r,o)},postJsonPayload:function(t,e,n,r,o){r&&c.isFunction(r)||(r=function(){}),u(t,c.formatUrl(e),"POST",n,r,o)}}},function(t,e,n){var b=n(0),w=n(4),r=n(1);function _(t,e,n){var r=t.message,o=t.custom;if(!r)if(o){var i=e.scrubFields,a=b.stringify(b.scrub(o,i));r=a.error||a.value||""}else r="";var s={body:r};o&&(s.extra=b.merge(o)),b.set(t,"data.body",{message:s}),n(null,t)}t.exports={handleItemWithError:function(e,t,n){if(e.data=e.data||{},e.err)try{e.stackInfo=e.err._savedStackTrace||w.parse(e.err)}catch(t){r.error("Error while parsing the error object.",t);try{e.message=e.err.message||e.err.description||e.message||String(e.err)}catch(t){e.message=String(e.err)||String(t)}delete e.err}n(null,e)},ensureItemHasSomethingToSay:function(t,e,n){t.message||t.stackInfo||t.custom||n(new Error("No message, stack info, or custom data"),null),n(null,t)},addBaseInfo:function(t,e,n){var r=e.payload&&e.payload.environment||e.environment;t.data=b.merge(t.data,{environment:r,level:t.level,endpoint:e.endpoint,platform:"browser",framework:"browser-js",language:"javascript",server:{},uuid:t.uuid,notifier:{name:"bugno-browser-js",version:e.version}}),n(null,t)},addRequestInfo:function(o){return function(t,e,n){if(!o||!o.location)return n(null,t);var r="$remote_ip";e.captureIp?!0!==e.captureIp&&(r+="_anonymize"):r=null,b.set(t,"data.request",{url:o.location.href,query_string:o.location.search,user_ip:r}),n(null,t)}},addClientInfo:function(i){return function(t,e,n){if(!i)return n(null,t);var r=i.navigator||{},o=i.screen||{};b.set(t,"data.client",{runtime_ms:t.timestamp-i._bugnoStartTime,timestamp:Math.round(t.timestamp/1e3),javascript:{browser:r.userAgent,language:r.language,cookie_enabled:r.cookieEnabled,screen:{width:o.width,height:o.height}}}),n(null,t)}},addPluginInfo:function(u){return function(t,e,n){if(!u||!u.navigator)return n(null,t);for(var r,o=[],i=u.navigator.plugins||[],a=0,s=i.length;a<s;++a)r=i[a],o.push({name:r.name,description:r.description});b.set(t,"data.client.javascript.plugins",o),n(null,t)}},addBody:function(t,e,n){t.stackInfo?function(t,e,n){var r=t.data.description,o=t.stackInfo,i=t.custom,a=w.guessErrorClass(o.message),s=o.name||a[0],u=a[1],c={exception:{class:s,message:u}};r&&(c.exception.description=r);var l=o.stack;l&&0===l.length&&t._unhandledStackInfo&&t._unhandledStackInfo.stack&&(l=t._unhandledStackInfo.stack);if(l){var p,f,h,d,g,m,v,y;for(0===l.length&&(c.exception.stack=o.rawStack,c.exception.raw=String(o.rawException)),c.frames=[],v=0;v<l.length;++v)p=l[v],f={filename:p.url?b.sanitizeUrl(p.url):"(unknown)",lineno:p.line||null,method:p.func&&"?"!==p.func?p.func:"[anonymous]",colno:p.column},e.sendFrameUrl&&(f.url=p.url),f.method&&f.method.endsWith&&f.method.endsWith("_bugno_wrapped")||(h=d=g=null,(m=p.context?p.context.length:0)&&(y=Math.floor(m/2),d=p.context.slice(0,y),h=p.context[y],g=p.context.slice(y)),h&&(f.code=h),(d||g)&&(f.context={},d&&d.length&&(f.context.pre=d),g&&g.length&&(f.context.post=g)),p.args&&(f.args=p.args),c.frames.push(f));i&&(c.extra=b.merge(i)),b.set(t,"data.body",{trace:c}),n(null,t)}else t.message=s+": "+u,_(t,e,n)}(t,e,n):_(t,e,n)},scrubPayload:function(t,e,n){var r=e.scrubFields;t.data=b.scrub(t.data,r),n(null,t)}}},function(t,e,n){var r,o,i;!function(){"use strict";o=[n(26)],void 0===(i="function"==typeof(r=function(u){"use strict";var r=/(^|@)\S+\:\d+/,o=/^\s*at .*(\S+\:\d+|\(native\))/m,i=/^(eval@)?(\[native code\])?$/;function a(t,e,n){if(typeof Array.prototype.map==="function"){return t.map(e,n)}else{var r=new Array(t.length);for(var o=0;o<t.length;o++){r[o]=e.call(n,t[o])}return r}}function s(t,e,n){if(typeof Array.prototype.filter==="function"){return t.filter(e,n)}else{var r=[];for(var o=0;o<t.length;o++){if(e.call(n,t[o])){r.push(t[o])}}return r}}return{parse:function t(e){if(typeof e.stacktrace!=="undefined"||typeof e["opera#sourceloc"]!=="undefined"){return this.parseOpera(e)}else if(e.stack&&e.stack.match(o)){return this.parseV8OrIE(e)}else if(e.stack){return this.parseFFOrSafari(e)}else{throw new Error("Cannot parse given Error object")}},extractLocation:function t(e){if(e.indexOf(":")===-1){return[e]}var n=e.replace(/[\(\)\s]/g,"").split(":");var r=n.pop();var o=n[n.length-1];if(!isNaN(parseFloat(o))&&isFinite(o)){var i=n.pop();return[n.join(":"),i,r]}else{return[n.join(":"),r,undefined]}},parseV8OrIE:function t(e){var n=s(e.stack.split("\n"),function(t){return!!t.match(o)},this);return a(n,function(t){if(t.indexOf("(eval ")>-1){t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,"")}var e=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1);var n=this.extractLocation(e.pop());var r=e.join(" ")||undefined;var o=n[0]==="eval"?undefined:n[0];return new u(r,undefined,o,n[1],n[2],t)},this)},parseFFOrSafari:function t(e){var n=s(e.stack.split("\n"),function(t){return!t.match(i)},this);return a(n,function(t){if(t.indexOf(" > eval")>-1){t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")}if(t.indexOf("@")===-1&&t.indexOf(":")===-1){return new u(t)}else{var e=t.split("@");var n=this.extractLocation(e.pop());var r=e.shift()||undefined;return new u(r,undefined,n[0],n[1],n[2],t)}},this)},parseOpera:function t(e){if(!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length){return this.parseOpera9(e)}else if(!e.stack){return this.parseOpera10(e)}else{return this.parseOpera11(e)}},parseOpera9:function t(e){var n=/Line (\d+).*script (?:in )?(\S+)/i;var r=e.message.split("\n");var o=[];for(var i=2,a=r.length;i<a;i+=2){var s=n.exec(r[i]);if(s){o.push(new u(undefined,undefined,s[2],s[1],undefined,r[i]))}}return o},parseOpera10:function t(e){var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var r=e.stacktrace.split("\n");var o=[];for(var i=0,a=r.length;i<a;i+=2){var s=n.exec(r[i]);if(s){o.push(new u(s[3]||undefined,undefined,s[2],s[1],undefined,r[i]))}}return o},parseOpera11:function t(e){var n=s(e.stack.split("\n"),function(t){return!!t.match(r)&&!t.match(/^Error created at/)},this);return a(n,function(t){var e=t.split("@");var n=this.extractLocation(e.pop());var r=e.shift()||"";var o=r.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||undefined;var i;if(r.match(/\(([^\)]*)\)/)){i=r.replace(/^[^\(]+\(([^\)]*)\)$/,"$1")}var a=i===undefined||i==="[arguments not available]"?undefined:i.split(",");return new u(o,a,n[0],n[1],n[2],t)},this)}}})?r.apply(e,o):r)||(t.exports=i)}()},function(t,e,n){var r,o,i;!function(){"use strict";o=[],void 0===(i="function"==typeof(r=function(){"use strict";function e(t){return!isNaN(parseFloat(t))&&isFinite(t)}function t(t,e,n,r,o,i){if(t!==undefined){this.setFunctionName(t)}if(e!==undefined){this.setArgs(e)}if(n!==undefined){this.setFileName(n)}if(r!==undefined){this.setLineNumber(r)}if(o!==undefined){this.setColumnNumber(o)}if(i!==undefined){this.setSource(i)}}return t.prototype={getFunctionName:function(){return this.functionName},setFunctionName:function(t){this.functionName=String(t)},getArgs:function(){return this.args},setArgs:function(t){if("[object Array]"!==Object.prototype.toString.call(t))throw new TypeError("Args must be an Array");this.args=t},getFileName:function(){return this.fileName},setFileName:function(t){this.fileName=String(t)},getLineNumber:function(){return this.lineNumber},setLineNumber:function(t){if(!e(t))throw new TypeError("Line Number must be a Number");this.lineNumber=Number(t)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(t){if(!e(t))throw new TypeError("Column Number must be a Number");this.columnNumber=Number(t)},getSource:function(){return this.source},setSource:function(t){this.source=String(t)},toString:function(){return(this.getFunctionName()||"{anonymous}")+("("+(this.getArgs()||[]).join(",")+")")+(this.getFileName()?"@"+this.getFileName():"")+(e(this.getLineNumber())?":"+this.getLineNumber():"")+(e(this.getColumnNumber())?":"+this.getColumnNumber():"")}},t})?r.apply(e,o):r)||(t.exports=i)}()},function(t,e,n){var s=n(0);t.exports={itemToPayload:function(t,e,n){var r=e.payload||{};r.body&&delete r.body;var o=s.merge(t.data,r);t._isUncaught&&(o._isUncaught=!0),t._originalArgs&&(o._originalArgs=t._originalArgs),n(null,o)},addTelemetryData:function(t,e,n){t.telemetryEvents&&s.set(t,"data.body.telemetry",t.telemetryEvents),n(null,t)},addMessageWithError:function(t,e,n){if(t.message){var r="data.body.trace_chain.0",o=s.get(t,r);if(o||(r="data.body.trace",o=s.get(t,r)),o){if(!o.exception||!o.exception.description)return s.set(t,r+".exception.description",t.message),void n(null,t);var i=s.get(t,r+".extra")||{},a=s.merge(i,{message:t.message});s.set(t,r+".extra",a)}n(null,t)}else n(null,t)},userTransform:function(o){return function(e,n,r){var t=s.merge(e);try{s.isFunction(n.transform)&&n.transform(t.data,e)}catch(t){return n.transform=null,o.error("Error while calling custom transform() function. Removing custom transform().",t),void r(null,e)}r(null,t)}},addConfigToPayload:function(t,e,n){if(!e.sendConfig)return n(null,t);var r=s.get(t,"data.custom")||{};r._bugnoConfig=e,t.data.custom=r,n(null,t)}}},function(t,e,n){var r=n(0);t.exports={checkIgnore:function(t,e){return!r.get(e,"plugins.jquery.ignoreAjaxErrors")||!r.get(t,"body.message.extra.isAjax")}}},function(t,e,n){var d=n(0);function r(t,e,n,r){var o,i,a,s,u,c,l,p,f=!1;"blacklist"===n&&(f=!0);try{if(c=(o=f?e.hostBlackList:e.hostWhiteList)&&o.length,i=d.get(t,"body.trace"),!o||0===c)return!f;if(!i||!i.frames||0===i.frames.length)return!f;for(s=i.frames.length,l=0;l<s;l++){if(a=i.frames[l].filename,!d.isType(a,"string"))return!f;for(p=0;p<c;p++)if(u=o[p],new RegExp(u).test(a))return!0}}catch(t){f?e.hostBlackList=null:e.hostWhiteList=null;var h=f?"hostBlackList":"hostWhiteList";return r.error("Error while reading your configuration's "+h+" option. Removing custom "+h+".",t),!f}return!1}t.exports={checkLevel:function(t,e){var n=t.level,r=d.LEVELS[n]||0,o=e.reportLevel;return!(r<(d.LEVELS[o]||0))},userCheckIgnore:function(o){return function(t,e){var n=!!t._isUncaught;delete t._isUncaught;var r=t._originalArgs;delete t._originalArgs;try{d.isFunction(e.onSendCallback)&&e.onSendCallback(n,r,t)}catch(t){e.onSendCallback=null,o.error("Error while calling onSendCallback, removing",t)}try{if(d.isFunction(e.checkIgnore)&&e.checkIgnore(n,r,t))return!1}catch(t){e.checkIgnore=null,o.error("Error while calling custom checkIgnore(), removing",t)}return!0}},urlIsNotBlacklisted:function(n){return function(t,e){return!r(t,e,"blacklist",n)}},urlIsWhitelisted:function(n){return function(t,e){return r(t,e,"whitelist",n)}},messageIsIgnored:function(l){return function(t,e){var n,r,o,i,a,s,u,c;try{if(a=!1,!(o=e.ignoredMessages)||0===o.length)return!0;if(s=t.body,u=d.get(s,"trace.exception.message"),c=d.get(s,"message.body"),!(n=u||c))return!0;for(i=o.length,r=0;r<i&&!(a=new RegExp(o[r],"gi").test(n));r++);}catch(t){e.ignoredMessages=null,l.error("Error while reading your configuration's ignoredMessages option. Removing custom ignoredMessages.")}return!a}}}},function(t,e,n){var g=n(0),i=n(3),a=n(31),s={network:!0,networkResponseHeaders:!1,networkResponseBody:!1,networkRequestBody:!1,log:!0,dom:!0,navigation:!0,connectivity:!0};function r(t,e,n,r,o){var i=t[e];t[e]=n(i),r&&r[o].push([t,e,i])}function o(t,e){for(var n;t[e].length;)(n=t[e].shift())[0][n[1]]=n[2]}function u(t,e,n,r,o){var i=t.autoInstrument;!1===t.enabled||!1===i?this.autoInstrument={}:(g.isType(i,"object")||(i=s),this.autoInstrument=g.merge(s,i)),this.scrubTelemetryInputs=!!t.scrubTelemetryInputs,this.telemetryScrubber=t.telemetryScrubber,this.defaultValueScrubber=function(t){for(var r=[],e=0;e<t.length;++e)r.push(new RegExp(t[e],"i"));return function(t){var e=function(t){if(!t||!t.attributes)return null;for(var e=t.attributes,n=0;n<e.length;++n)if("name"===e[n].key)return e[n].value;return null}(t);if(!e)return!1;for(var n=0;n<r.length;++n)if(r[n].test(e))return!0;return!1}}(t.scrubFields),this.telemeter=e,this.bugno=n,this._window=r||{},this._document=o||{},this.replacements={network:[],log:[],navigation:[],connectivity:[]},this.eventRemovers={dom:[],connectivity:[]},this._location=this._window.location,this._lastHref=this._location&&this._location.href}u.prototype.configure=function(t){var e=t.autoInstrument,n=g.merge(this.autoInstrument);!1===t.enabled||!1===e?this.autoInstrument={}:(g.isType(e,"object")||(e=s),this.autoInstrument=g.merge(s,e)),this.instrument(n),void 0!==t.scrubTelemetryInputs&&(this.scrubTelemetryInputs=!!t.scrubTelemetryInputs),void 0!==t.telemetryScrubber&&(this.telemetryScrubber=t.telemetryScrubber)},u.prototype.instrument=function(t){!this.autoInstrument.network||t&&t.network?!this.autoInstrument.network&&t&&t.network&&this.deinstrumentNetwork():this.instrumentNetwork(),!this.autoInstrument.log||t&&t.log?!this.autoInstrument.log&&t&&t.log&&this.deinstrumentConsole():this.instrumentConsole(),!this.autoInstrument.dom||t&&t.dom?!this.autoInstrument.dom&&t&&t.dom&&this.deinstrumentDom():this.instrumentDom(),!this.autoInstrument.navigation||t&&t.navigation?!this.autoInstrument.navigation&&t&&t.navigation&&this.deinstrumentNavigation():this.instrumentNavigation(),!this.autoInstrument.connectivity||t&&t.connectivity?!this.autoInstrument.connectivity&&t&&t.connectivity&&this.deinstrumentConnectivity():this.instrumentConnectivity()},u.prototype.deinstrumentNetwork=function(){o(this.replacements,"network")},u.prototype.instrumentNetwork=function(){var d=this;function n(t,e){t in e&&g.isFunction(e[t])&&r(e,t,function(t){return d.bugno.wrap(t)})}if("XMLHttpRequest"in this._window){var t=this._window.XMLHttpRequest.prototype;r(t,"open",function(n){return function(t,e){return g.isType(e,"string")&&(this.__bugno_xhr={method:t,url:e,status_code:null,start_time_ms:g.now(),end_time_ms:null}),n.apply(this,arguments)}},this.replacements,"network"),r(t,"send",function(t){return function(f){var h=this;function e(){if(h.__bugno_xhr){if(null===h.__bugno_xhr.status_code){h.__bugno_xhr.status_code=0;var t=null;d.autoInstrument.networkRequestBody&&(t=f),h.__bugno_event=d.telemeter.captureNetwork(h.__bugno_xhr,"xhr",void 0,t)}if(h.readyState<2&&(h.__bugno_xhr.start_time_ms=g.now()),3<h.readyState){h.__bugno_xhr.end_time_ms=g.now();var e=null;if(d.autoInstrument.networkResponseHeaders){var n=d.autoInstrument.networkResponseHeaders;e={};try{var r,o;if(!0===n){var i=h.getAllResponseHeaders();if(i){var a,s,u=i.trim().split(/[\r\n]+/);for(o=0;o<u.length;o++)r=(a=u[o].split(": ")).shift(),s=a.join(": "),e[r]=s}}else for(o=0;o<n.length;o++)e[r=n[o]]=h.getResponseHeader(r)}catch(t){}}var c=null;if(d.autoInstrument.networkResponseBody)try{c=h.responseText}catch(t){}var l=null;(c||e)&&(l={},c&&(l.body=c),e&&(l.headers=e)),l&&(h.__bugno_xhr.response=l);try{var p=h.status;p=1223===p?204:p,h.__bugno_xhr.status_code=p,h.__bugno_event.level=d.telemeter.levelFromStatus(p)}catch(t){}}}}return n("onload",h),n("onerror",h),n("onprogress",h),"onreadystatechange"in h&&g.isFunction(h.onreadystatechange)?r(h,"onreadystatechange",function(t){return d.bugno.wrap(t,void 0,e)}):h.onreadystatechange=e,t.apply(this,arguments)}},this.replacements,"network")}"fetch"in this._window&&r(this._window,"fetch",function(l){return function(t,e){for(var n=new Array(arguments.length),r=0,o=n.length;r<o;r++)n[r]=arguments[r];var i,a=n[0],s="GET";g.isType(a,"string")?i=a:a&&(i=a.url,a.method&&(s=a.method)),n[1]&&n[1].method&&(s=n[1].method);var u={method:s,url:i,status_code:null,start_time_ms:g.now(),end_time_ms:null},c=null;return d.autoInstrument.networkRequestBody&&(n[1]&&n[1].body?c=n[1].body:n[0]&&!g.isType(n[0],"string")&&n[0].body&&(c=n[0].body)),d.telemeter.captureNetwork(u,"fetch",void 0,c),l.apply(this,n).then(function(t){u.end_time_ms=g.now(),u.status_code=t.status;var e=null;if(d.autoInstrument.networkResponseHeaders){var n=d.autoInstrument.networkResponseHeaders;e={};try{if(!0===n);else for(var r=0;r<n.length;r++){var o=n[r];e[o]=t.headers.get(o)}}catch(t){}}var i=null;return e&&(i={headers:e}),i&&(u.response=i),t})}},this.replacements,"network")},u.prototype.deinstrumentConsole=function(){if("console"in this._window&&this._window.console.log)for(var t;this.replacements.log.length;)t=this.replacements.log.shift(),this._window.console[t[0]]=t[1]},u.prototype.instrumentConsole=function(){if("console"in this._window&&this._window.console.log)for(var i=this,e=this._window.console,t=["debug","info","warn","error","log"],n=0,r=t.length;n<r;n++)o(t[n]);function o(t){var n=e[t],r=e,o="warn"===t?"warning":t;e[t]=function(){var t=Array.prototype.slice.call(arguments),e=g.formatArgsAsString(t);i.telemeter.captureLog(e,o),n&&Function.prototype.apply.call(n,r,t)},i.replacements.log.push([t,n])}},u.prototype.deinstrumentDom=function(){("addEventListener"in this._window||"attachEvent"in this._window)&&this.removeListeners("dom")},u.prototype.instrumentDom=function(){if("addEventListener"in this._window||"attachEvent"in this._window){var t=this.handleClick.bind(this),e=this.handleBlur.bind(this);this.addListener("dom",this._window,"click","onclick",t,!0),this.addListener("dom",this._window,"blur","onfocusout",e,!0)}},u.prototype.handleClick=function(t){try{var e=a.getElementFromEvent(t,this._document),n=e&&e.tagName,r=a.isDescribedElement(e,"a")||a.isDescribedElement(e,"button");n&&(r||a.isDescribedElement(e,"input",["button","submit"]))?this.captureDomEvent("click",e):a.isDescribedElement(e,"input",["checkbox","radio"])&&this.captureDomEvent("input",e,e.value,e.checked)}catch(t){}},u.prototype.handleBlur=function(t){try{var e=a.getElementFromEvent(t,this._document);e&&e.tagName&&(a.isDescribedElement(e,"textarea")?this.captureDomEvent("input",e,e.value):a.isDescribedElement(e,"select")&&e.options&&e.options.length?this.handleSelectInputChanged(e):a.isDescribedElement(e,"input")&&!a.isDescribedElement(e,"input",["button","submit","hidden","checkbox","radio"])&&this.captureDomEvent("input",e,e.value))}catch(t){}},u.prototype.handleSelectInputChanged=function(t){if(t.multiple)for(var e=0;e<t.options.length;e++)t.options[e].selected&&this.captureDomEvent("input",t,t.options[e].value);else 0<=t.selectedIndex&&t.options[t.selectedIndex]&&this.captureDomEvent("input",t,t.options[t.selectedIndex].value)},u.prototype.captureDomEvent=function(t,e,n,r){if(void 0!==n)if(this.scrubTelemetryInputs||"password"===a.getElementType(e))n="[scrubbed]";else{var o=a.describeElement(e);this.telemetryScrubber?this.telemetryScrubber(o)&&(n="[scrubbed]"):this.defaultValueScrubber(o)&&(n="[scrubbed]")}var i=a.elementArrayToString(a.treeToArray(e));this.telemeter.captureDom(t,i,n,r)},u.prototype.deinstrumentNavigation=function(){var t=this._window.chrome;t&&t.app&&t.app.runtime||!this._window.history||!this._window.history.pushState||o(this.replacements,"navigation")},u.prototype.instrumentNavigation=function(){var t=this._window.chrome;if(!(t&&t.app&&t.app.runtime)&&this._window.history&&this._window.history.pushState){var n=this;r(this._window,"onpopstate",function(e){return function(){var t=n._location.href;n.handleUrlChange(n._lastHref,t),e&&e.apply(this,arguments)}},this.replacements,"navigation"),r(this._window.history,"pushState",function(e){return function(){var t=2<arguments.length?arguments[2]:void 0;return t&&n.handleUrlChange(n._lastHref,t+""),e.apply(this,arguments)}},this.replacements,"navigation")}},u.prototype.handleUrlChange=function(t,e){var n=i.parse(this._location.href),r=i.parse(e),o=i.parse(t);this._lastHref=e,n.protocol===r.protocol&&n.host===r.host&&(e=r.path+(r.hash||"")),n.protocol===o.protocol&&n.host===o.host&&(t=o.path+(o.hash||"")),this.telemeter.captureNavigation(t,e)},u.prototype.deinstrumentConnectivity=function(){("addEventListener"in this._window||"body"in this._document)&&(this._window.addEventListener?this.removeListeners("connectivity"):o(this.replacements,"connectivity"))},u.prototype.instrumentConnectivity=function(){if("addEventListener"in this._window||"body"in this._document)if(this._window.addEventListener)this.addListener("connectivity",this._window,"online",void 0,function(){this.telemeter.captureConnectivityChange("online")}.bind(this),!0),this.addListener("connectivity",this._window,"offline",void 0,function(){this.telemeter.captureConnectivityChange("offline")}.bind(this),!0);else{var e=this;r(this._document.body,"ononline",function(t){return function(){e.telemeter.captureConnectivityChange("online"),t&&t.apply(this,arguments)}},this.replacements,"connectivity"),r(this._document.body,"onoffline",function(t){return function(){e.telemeter.captureConnectivityChange("offline"),t&&t.apply(this,arguments)}},this.replacements,"connectivity")}},u.prototype.addListener=function(t,e,n,r,o,i){e.addEventListener?(e.addEventListener(n,o,i),this.eventRemovers[t].push(function(){e.removeEventListener(n,o,i)})):r&&(e.attachEvent(r,o),this.eventRemovers[t].push(function(){e.detachEvent(r,o)}))},u.prototype.removeListeners=function(t){for(;this.eventRemovers[t].length;)this.eventRemovers[t].shift()()},t.exports=u},function(t,e){function o(t){return(t.getAttribute("type")||"").toLowerCase()}function s(t){if(!t||!t.tagName)return"";var e=[t.tagName];t.id&&e.push("#"+t.id),t.classes&&e.push("."+t.classes.join("."));for(var n=0;n<t.attributes.length;n++)e.push("["+t.attributes[n].key+'="'+t.attributes[n].value+'"]');return e.join("")}function i(t){if(!t||!t.tagName)return null;var e,n,r,o,i={};i.tagName=t.tagName.toLowerCase(),t.id&&(i.id=t.id),(e=t.className)&&"string"==typeof e&&(i.classes=e.split(/\s+/));var a=["type","name","title","alt"];for(i.attributes=[],o=0;o<a.length;o++)n=a[o],(r=t.getAttribute(n))&&i.attributes.push({key:n,value:r});return i}t.exports={describeElement:i,descriptionToString:s,elementArrayToString:function(t){for(var e,n,r=" > ".length,o=[],i=0,a=t.length-1;0<=a;a--){if(e=s(t[a]),n=i+o.length*r+e.length,a<t.length-1&&83<=n){o.unshift("...");break}o.unshift(e),i+=e.length}return o.join(" > ")},treeToArray:function(t){for(var e,n=[],r=0;t&&r<5&&"html"!==(e=i(t)).tagName;r++)n.unshift(e),t=t.parentNode;return n},getElementFromEvent:function(t,e){return t.target?t.target:e&&e.elementFromPoint?e.elementFromPoint(t.clientX,t.clientY):void 0},isDescribedElement:function(t,e,n){if(t.tagName.toLowerCase()!==e.toLowerCase())return!1;if(!n)return!0;t=o(t);for(var r=0;r<n.length;r++)if(n[r]===t)return!0;return!1},getElementType:o}}],o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=5);function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}var n,r});
//# sourceMappingURL=bugno.umd.min.js.map